<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script src="https://apis.google.com/js/api.js?onload=onApiLoad"></script>
    <!-- The CSS package above applies Google styling to buttons and other elements. -->

    <style>
    .branding-below {
      bottom: 56px;
      top: 0;
    }

    .branding-text {
      left: 7px;
      position: relative;
      top: 3px;
    }

    .col-contain {
      overflow: hidden;
    }

    .col-one {
      float: left;
      width: 50%;
    }

    .logo {
      vertical-align: middle;
    }

    .radio-spacer {
      height: 20px;
    }

    .width-100 {
      width: 100%;
    }
    
    table {
      border-collapse: collapse;
      width: 80%;
    }
    
    table, th, td {
      border: 1px solid black;
    }
    
    th, td {
      text-align: center;
      padding: 15px;
    }
    
    </style>
    <script>
    
    /**
      * @desc - Scans the data for statistics
      * @author - hendersonam
      */
    function scanData() {
    scanStats();
    scanChanges();
    google.script.run.withSuccessHandler(displayDropdown).getDropdownList();
    }
    
    /**
      * @desc - Scans the statistics
      * @author - hendersonam
      */
    function scanStats() {
    google.script.run.withSuccessHandler(displayStats).getStatistics();
    }
    
    /**
      * @desc - Scans the schedule changes
      * @author - hendersonam
      */
    function scanChanges() {
    google.script.run.withSuccessHandler(displayScheduleChanges).getScheduleChanges();
    }
    
    /**
      * @desc - Dissplays the dropdown menu to list the columns that can be used for filtering
      * @author - hendersonam
      */
    function displayDropdown(list) {
    
    var html = document.getElementById('dropdownfilter');
    html.innerHTML = list;
    }
    
    /**
      * @desc - Displays Lunch Statistics
      * @author - hendersonam
      */
    function displayStats(statistics) {
      
      var html = document.getElementById('stats');
      html.innerHTML = statistics;
      
    } 
    
    /**
      * @desc - Displays Schedule Changes
      * @author - hendersonam
      */
    function displayScheduleChanges(changes) {
      
      var html = document.getElementById('changes');
      html.innerHTML = changes;
      
    }
    
    /**
     * @desc - If the enter key is pressed, hideValues that do not contain the string in the text box
     * @param - event - the button that is pressed
     * @author - hendersonam
     */
    function mySearch(e) {
      var key= e.keyCode || e.which;
      if (key==13){
        var filter = document.getElementById('filter').value.toLowerCase();
        var column = document.getElementById('dropdownfilter').value;
        google.script.run.hideValues(filter, column);
      }
    }
    
    </script>
  </head>
    <body>
      
      <button class="action" onclick="google.script.run.startTableAssigning()">Clean</button>
      <button class="action" onclick="scanData()">Scan</button>
      <button class="action" onclick="google.script.run.showAllValues()">Show</button>
      
      <select id="dropdownfilter"></select>
      <input type="text" id="filter" onkeypress="mySearch(event)" placeholder="Search for names..">
      
      <div id="changes"></div>
      <div id="stats"></div>
    </body>
</html>